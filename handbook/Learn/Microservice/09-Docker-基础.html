<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker-基础 | Code Diary</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/learn-ceiling/hand.jpg">
    <meta name="description" content="技术笔记、编程心得分享">
    <meta name="referrer" content="no-referrer">
    
    <link rel="preload" href="/learn-ceiling/assets/css/0.styles.df47c79f.css" as="style"><link rel="preload" href="/learn-ceiling/assets/js/app.235538a9.js" as="script"><link rel="preload" href="/learn-ceiling/assets/js/2.c7d2b1f7.js" as="script"><link rel="preload" href="/learn-ceiling/assets/js/43.cd846378.js" as="script"><link rel="prefetch" href="/learn-ceiling/assets/js/10.c4c4f495.js"><link rel="prefetch" href="/learn-ceiling/assets/js/11.06c1692d.js"><link rel="prefetch" href="/learn-ceiling/assets/js/12.e70990f1.js"><link rel="prefetch" href="/learn-ceiling/assets/js/13.5ea6f405.js"><link rel="prefetch" href="/learn-ceiling/assets/js/14.5ce76ccb.js"><link rel="prefetch" href="/learn-ceiling/assets/js/15.b5c61832.js"><link rel="prefetch" href="/learn-ceiling/assets/js/16.6e4e0759.js"><link rel="prefetch" href="/learn-ceiling/assets/js/17.b6f52e7f.js"><link rel="prefetch" href="/learn-ceiling/assets/js/18.155f2caf.js"><link rel="prefetch" href="/learn-ceiling/assets/js/19.ea21c3cf.js"><link rel="prefetch" href="/learn-ceiling/assets/js/20.33c43e06.js"><link rel="prefetch" href="/learn-ceiling/assets/js/21.f4e6e20a.js"><link rel="prefetch" href="/learn-ceiling/assets/js/22.485d0a07.js"><link rel="prefetch" href="/learn-ceiling/assets/js/23.fb805a45.js"><link rel="prefetch" href="/learn-ceiling/assets/js/24.6a258cf5.js"><link rel="prefetch" href="/learn-ceiling/assets/js/25.c4c4023d.js"><link rel="prefetch" href="/learn-ceiling/assets/js/26.d92cf884.js"><link rel="prefetch" href="/learn-ceiling/assets/js/27.5d88d619.js"><link rel="prefetch" href="/learn-ceiling/assets/js/28.a0b76e62.js"><link rel="prefetch" href="/learn-ceiling/assets/js/29.3f0426da.js"><link rel="prefetch" href="/learn-ceiling/assets/js/3.d1fbc4fe.js"><link rel="prefetch" href="/learn-ceiling/assets/js/30.7adccd2c.js"><link rel="prefetch" href="/learn-ceiling/assets/js/31.7d0b9a7f.js"><link rel="prefetch" href="/learn-ceiling/assets/js/32.6970bcc0.js"><link rel="prefetch" href="/learn-ceiling/assets/js/33.eeb35d50.js"><link rel="prefetch" href="/learn-ceiling/assets/js/34.ea24ea8b.js"><link rel="prefetch" href="/learn-ceiling/assets/js/35.c40a585a.js"><link rel="prefetch" href="/learn-ceiling/assets/js/36.79790a12.js"><link rel="prefetch" href="/learn-ceiling/assets/js/37.a847b8a1.js"><link rel="prefetch" href="/learn-ceiling/assets/js/38.9a6ab34d.js"><link rel="prefetch" href="/learn-ceiling/assets/js/39.bf0bc1a7.js"><link rel="prefetch" href="/learn-ceiling/assets/js/4.b6acf418.js"><link rel="prefetch" href="/learn-ceiling/assets/js/40.2e93acfd.js"><link rel="prefetch" href="/learn-ceiling/assets/js/41.bcc213e5.js"><link rel="prefetch" href="/learn-ceiling/assets/js/42.558394fc.js"><link rel="prefetch" href="/learn-ceiling/assets/js/44.afcb9063.js"><link rel="prefetch" href="/learn-ceiling/assets/js/45.526cdab6.js"><link rel="prefetch" href="/learn-ceiling/assets/js/46.3bbeeda3.js"><link rel="prefetch" href="/learn-ceiling/assets/js/47.dba7847e.js"><link rel="prefetch" href="/learn-ceiling/assets/js/48.29379048.js"><link rel="prefetch" href="/learn-ceiling/assets/js/49.f526a58a.js"><link rel="prefetch" href="/learn-ceiling/assets/js/5.3747e8f8.js"><link rel="prefetch" href="/learn-ceiling/assets/js/50.2be0a3da.js"><link rel="prefetch" href="/learn-ceiling/assets/js/51.46ccf051.js"><link rel="prefetch" href="/learn-ceiling/assets/js/52.9bcd0722.js"><link rel="prefetch" href="/learn-ceiling/assets/js/53.06fef668.js"><link rel="prefetch" href="/learn-ceiling/assets/js/54.534da4f1.js"><link rel="prefetch" href="/learn-ceiling/assets/js/55.22f59a2a.js"><link rel="prefetch" href="/learn-ceiling/assets/js/56.5b1e2aa6.js"><link rel="prefetch" href="/learn-ceiling/assets/js/57.daacfc08.js"><link rel="prefetch" href="/learn-ceiling/assets/js/58.cb240494.js"><link rel="prefetch" href="/learn-ceiling/assets/js/59.f0cab42c.js"><link rel="prefetch" href="/learn-ceiling/assets/js/6.3688e4ed.js"><link rel="prefetch" href="/learn-ceiling/assets/js/60.74872728.js"><link rel="prefetch" href="/learn-ceiling/assets/js/61.a7a19f44.js"><link rel="prefetch" href="/learn-ceiling/assets/js/62.bda341fd.js"><link rel="prefetch" href="/learn-ceiling/assets/js/63.39847a02.js"><link rel="prefetch" href="/learn-ceiling/assets/js/64.8ac906c5.js"><link rel="prefetch" href="/learn-ceiling/assets/js/7.dddd7af2.js"><link rel="prefetch" href="/learn-ceiling/assets/js/8.4b31d8be.js"><link rel="prefetch" href="/learn-ceiling/assets/js/9.9a27c3e2.js">
    <link rel="stylesheet" href="/learn-ceiling/assets/css/0.styles.df47c79f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><main><main slot="sidebar-top"><a href="https://github.com/25122lxy/" aria-label="View source on GitHub" target="_blank" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path> <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" class="octo-arm" style="transform-origin: 130px 106px;"></path> <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></main> <div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-ceiling/" class="home-link router-link-active"><!----> <span class="site-name">Code Diary</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/learn-ceiling/" class="nav-link">
  Index
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn" class="dropdown-title"><span class="title">Learn</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn" class="mobile-dropdown-title"><span class="title">Learn</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/Microservice/01-初识微服务.html" class="nav-link">
  Microservice
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/RabbitMQ/1.RabbitMQ-简介及安装.html" class="nav-link">
  RabbitMQ
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/Redis/0-Redis-Basic.html" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/SQL/SQL案例.html" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/前端快速入门/01-HTML-CSS.html" class="nav-link">
  前端快速入门
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/Linux/01-Linux入门.html" class="nav-link">
  Linux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Project" class="dropdown-title"><span class="title">Project</span> <span class="arrow down"></span></button> <button type="button" aria-label="Project" class="mobile-dropdown-title"><span class="title">Project</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/RabbitMQ/1.RabbitMQ-简介及安装.html" class="nav-link">
  社区精品汇
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Interview" class="dropdown-title"><span class="title">Interview</span> <span class="arrow down"></span></button> <button type="button" aria-label="Interview" class="mobile-dropdown-title"><span class="title">Interview</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/00-查漏补缺.html" class="nav-link">
  查漏补缺
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/01-Java基础.html" class="nav-link">
  Java基础
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/02-Redis.html" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/03-MySQL.html" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/04-Java框架.html" class="nav-link">
  Java框架
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/05-微服务.html" class="nav-link">
  微服务
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/06-消息中间件.html" class="nav-link">
  消息中间件
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/07-Java集合.html" class="nav-link">
  Java集合
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/08-Java并发.html" class="nav-link">
  Java并发
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/09-JVM.html" class="nav-link">
  JVM
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/10-Linux.html" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/11-Hadoop.html" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/12-Hive.html" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/13-Spark.html" class="nav-link">
  Spark
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/16-数据采集工具.html" class="nav-link">
  数据采集工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="lxy25122-blog" class="dropdown-title"><span class="title">lxy25122-blog</span> <span class="arrow down"></span></button> <button type="button" aria-label="lxy25122-blog" class="mobile-dropdown-title"><span class="title">lxy25122-blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lxy25122" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/tjlxy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/learn-ceiling/" class="nav-link">
  Index
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn" class="dropdown-title"><span class="title">Learn</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn" class="mobile-dropdown-title"><span class="title">Learn</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/Microservice/01-初识微服务.html" class="nav-link">
  Microservice
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/RabbitMQ/1.RabbitMQ-简介及安装.html" class="nav-link">
  RabbitMQ
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/Redis/0-Redis-Basic.html" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/SQL/SQL案例.html" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/前端快速入门/01-HTML-CSS.html" class="nav-link">
  前端快速入门
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/Linux/01-Linux入门.html" class="nav-link">
  Linux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Project" class="dropdown-title"><span class="title">Project</span> <span class="arrow down"></span></button> <button type="button" aria-label="Project" class="mobile-dropdown-title"><span class="title">Project</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Learn/RabbitMQ/1.RabbitMQ-简介及安装.html" class="nav-link">
  社区精品汇
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Interview" class="dropdown-title"><span class="title">Interview</span> <span class="arrow down"></span></button> <button type="button" aria-label="Interview" class="mobile-dropdown-title"><span class="title">Interview</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/00-查漏补缺.html" class="nav-link">
  查漏补缺
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/01-Java基础.html" class="nav-link">
  Java基础
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/02-Redis.html" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/03-MySQL.html" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/04-Java框架.html" class="nav-link">
  Java框架
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/05-微服务.html" class="nav-link">
  微服务
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/06-消息中间件.html" class="nav-link">
  消息中间件
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/07-Java集合.html" class="nav-link">
  Java集合
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/08-Java并发.html" class="nav-link">
  Java并发
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/09-JVM.html" class="nav-link">
  JVM
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/10-Linux.html" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/11-Hadoop.html" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/12-Hive.html" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/13-Spark.html" class="nav-link">
  Spark
</a></li><li class="dropdown-item"><!----> <a href="/learn-ceiling/handbook/Interview/16-数据采集工具.html" class="nav-link">
  数据采集工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="lxy25122-blog" class="dropdown-title"><span class="title">lxy25122-blog</span> <span class="arrow down"></span></button> <button type="button" aria-label="lxy25122-blog" class="mobile-dropdown-title"><span class="title">lxy25122-blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lxy25122" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/tjlxy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/learn-ceiling/" aria-current="page" class="sidebar-link">学前必读</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Learn</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Microservice</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-ceiling/handbook/Learn/Microservice/01-初识微服务.html" class="sidebar-link">初识微服务</a></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/02-Eureka注册中心.html" class="sidebar-link">Eureka注册中心</a></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/03-Ribbon负载均衡.html" class="sidebar-link">Ribbon负载均衡</a></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/04-Nacos注册中心.html" class="sidebar-link">Nacos注册中心</a></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/05-Nacos配置管理.html" class="sidebar-link">Nacos配置管理</a></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/06-Feign远程调用.html" class="sidebar-link">Feign远程调用</a></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/07-Gateway服务网关.html" class="sidebar-link">Gateway服务网关</a></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/08-Docker-介绍及安装.html" class="sidebar-link">Docker-介绍及安装</a></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html" class="active sidebar-link">Docker-基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_1-镜像操作" class="sidebar-link">1. 镜像操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_1-1-镜像名称" class="sidebar-link">1.1 镜像名称</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_1-2-镜像命令" class="sidebar-link">1.2 镜像命令</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_1-3-创建nginx镜像案例" class="sidebar-link">1.3 创建Nginx镜像案例</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_2-容器操作" class="sidebar-link">2. 容器操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_2-1-容器相关命令" class="sidebar-link">2.1 容器相关命令</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_2-2-案例-启动nginx容器" class="sidebar-link">2.2 案例-启动Nginx容器</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_2-3-案例-运行redis容器" class="sidebar-link">2.3 案例-运行Redis容器</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_2-4-小结" class="sidebar-link">2.4 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_3-数据卷" class="sidebar-link">3. 数据卷</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_3-1-什么是数据卷" class="sidebar-link">3.1 什么是数据卷</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_3-2-数据集操作命令" class="sidebar-link">3.2 数据集操作命令</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_3-3-创建和查看数据卷" class="sidebar-link">3.3 创建和查看数据卷</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_3-4-挂载数据卷" class="sidebar-link">3.4 挂载数据卷</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_3-5-案例-给nginx挂载数据卷" class="sidebar-link">3.5 案例-给Nginx挂载数据卷</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_3-6-案例-给mysql挂载本地目录" class="sidebar-link">3.6 案例-给MySQL挂载本地目录</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_3-7-小结" class="sidebar-link">3.7 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_4-自定义镜像" class="sidebar-link">4.自定义镜像</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_4-1-镜像结构" class="sidebar-link">4.1 镜像结构</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_4-2-dockerfile" class="sidebar-link">4.2 Dockerfile</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_4-3-构建镜像" class="sidebar-link">4.3 构建镜像</a></li></ul></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#_5-网络" class="sidebar-link">5.网络</a></li><li class="sidebar-sub-header"><a href="/learn-ceiling/handbook/Learn/Microservice/09-Docker-基础.html#常用软件部署示例" class="sidebar-link">常用软件部署示例</a></li></ul></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/10-Docker-项目部署.html" class="sidebar-link">Docker-项目部署</a></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/11-RabbitMQ-快速入门.html" class="sidebar-link">RabbitMQ-快速入门</a></li><li><a href="/learn-ceiling/handbook/Learn/Microservice/12-RabbitMQ-SpringAMQP.html" class="sidebar-link">RabbitMQ-SpringAMQP</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>RabbitMQ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>SQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>前端快速入门</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Project</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Interview</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker-基础"><a href="#docker-基础" class="header-anchor">#</a> <strong>Docker</strong>-基础</h1> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230914184846374.png" alt="image-20230914184846374"></p> <h2 id="_1-镜像操作"><a href="#_1-镜像操作" class="header-anchor">#</a> 1. 镜像操作</h2> <h3 id="_1-1-镜像名称"><a href="#_1-1-镜像名称" class="header-anchor">#</a> 1.1 镜像名称</h3> <p>首先来看下镜像的名称组成：</p> <ul><li>镜名称一般分两部分组成：[repository]:[tag]。</li> <li>在没有指定tag时，默认是latest，代表最新版本的镜像</li></ul> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230612154232614.png" alt="image-20230612154232614"></p> <p>这里的mysql就是repository，5.7就是tag，合一起就是镜像名称，代表5.7版本的MySQL镜像。</p> <h3 id="_1-2-镜像命令"><a href="#_1-2-镜像命令" class="header-anchor">#</a> 1.2 镜像命令</h3> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230612154319727.png" alt="image-20230612154319727"></p> <h3 id="_1-3-创建nginx镜像案例"><a href="#_1-3-创建nginx镜像案例" class="header-anchor">#</a> 1.3 创建Nginx镜像案例</h3> <p>https://hub.docker.com/ 可以在镜像仓库中搜索，查看官方教程</p> <ul><li><p>拉取镜像</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> pull nginx
</code></pre></div></li> <li><p>查看拉取到的镜像</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> images
</code></pre></div></li> <li><p>导出镜像</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> save <span class="token parameter variable">-o</span> nginx.tar nginx:latest
</code></pre></div></li> <li><p>加载镜像（需要先删除本地镜像）</p> <p>删除本地镜像</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> rmi nginx:latest
</code></pre></div><p>加载本地的镜像</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> load <span class="token parameter variable">-i</span> nginx.tar
</code></pre></div><p>再次查看镜像，加载成功<code>docker images</code></p></li></ul> <h2 id="_2-容器操作"><a href="#_2-容器操作" class="header-anchor">#</a> 2. 容器操作</h2> <h3 id="_2-1-容器相关命令"><a href="#_2-1-容器相关命令" class="header-anchor">#</a> 2.1 容器相关命令</h3> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230612161502634.png" alt="image-20230612161502634"></p> <p>容器保护三个状态：</p> <ul><li>运行：进程正常运行</li> <li>暂停：进程暂停，CPU不再运行，并不释放内存</li> <li>停止：进程终止，回收进程占用的内存、CPU等资源</li></ul> <p>其中：</p> <ul><li>docker run：创建并运行一个容器，处于运行状态</li> <li>docker pause：让一个运行的容器暂停</li> <li>docker unpause：让一个容器从暂停状态恢复运行</li> <li>docker stop：停止一个运行的容器</li> <li>docker start：让一个停止的容器再次运行</li> <li>docker rm：删除一个容器</li> <li><code>docker inspect xx</code>查看容器详情</li> <li><code>docker logs -f xx</code>查看容器运行日志</li></ul> <h3 id="_2-2-案例-启动nginx容器"><a href="#_2-2-案例-启动nginx容器" class="header-anchor">#</a> 2.2 案例-启动Nginx容器</h3> <ul><li><p>在上述创建成功基础上，运行容器</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span> nginxContainer <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">-d</span> nginx
</code></pre></div><p>命令解读：</p> <ul><li>docker run ：创建并运行一个容器</li> <li>--name : 给容器起一个名字，比如叫做 <code>nginxContainer</code></li> <li>-p ：将宿主机端口与容器端口映射，冒号左侧是宿主机端口，右侧是容器端口</li> <li>-d：后台运行容器</li> <li>nginx：镜像名称，例如nginx</li></ul> <p>这里的<code>-p</code>参数，是将容器端口映射到宿主机端口。</p> <p>默认情况下，容器是隔离环境，我们直接访问宿主机的80端口，肯定访问不到容器中的nginx。</p> <p>现在，将容器的80与宿主机的80关联起来，当我们访问宿主机的80端口时，就会被映射到容器的80，这样就能访问到nginx了：</p> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230612162032232.png" alt="image-20230612162032232"></p></li> <li><p>进入容器，修改文件</p> <p>进入Nginx容器，修改HTML文件内容</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> nginxContainer <span class="token function">bash</span>
</code></pre></div><p>命令解读：</p> <ul><li>docker exec ：进入容器内部，执行一个命令</li> <li>-it : 给当前进入的容器创建一个标准输入、输出终端，允许我们与容器交互</li> <li>nginxContainer：要进入的容器的名称</li> <li>bash：进入容器后执行的命令，bash是一个linux终端交互命令</li></ul> <p>进入nginx的HTML所在目录 /usr/share/nginx/html（<strong>镜像仓库官网可以查询路径</strong>）</p> <p>容器内部会模拟一个独立的Linux文件系统，看起来如同一个linux服务器一样：</p> <p>nginx的环境、配置、运行文件全部都在这个文件系统中，包括我们要修改的html文件。</p> <p>查看DockerHub网站中的nginx页面，可以知道nginx的html目录位置在<code>/usr/share/nginx/html</code></p> <p>我们执行命令，进入该目录：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> /usr/share/nginx/html
</code></pre></div><p>容器内没有vi命令，无法直接修改，我们用下面的命令来修改：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token parameter variable">-e</span> <span class="token string">'s#Welcome to nginx#你好 bigdata#g'</span> <span class="token parameter variable">-e</span> <span class="token string">'s#&lt;head&gt;#&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;#g'</span> index.html
</code></pre></div><p>在浏览器访问 centos7即可看到结果</p></li></ul> <h3 id="_2-3-案例-运行redis容器"><a href="#_2-3-案例-运行redis容器" class="header-anchor">#</a> 2.3 案例-运行Redis容器</h3> <ul><li><p>拉取镜像</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> pull redis
</code></pre></div></li> <li><p>查看拉取的镜像</p> <div class="language- extra-class"><pre class="language-text"><code>docker images
</code></pre></div></li> <li><p>运行Redis容器</p> <div class="language-sh' extra-class"><pre class="language-text"><code>docker run --name redisContainer -p 6379:6379 -d redis redis-server --appendonly yes
</code></pre></div><p>命令解读：</p> <ul><li>docker run ：创建并运行一个容器</li> <li>--name : 给容器起一个名字，比如叫做 <code>redisContainer</code></li> <li>-p ：将宿主机端口与容器端口映射，冒号左侧是宿主机端口，右侧是容器端口</li> <li>-d：后台运行容器</li> <li>redis：镜像名称，例如redis</li> <li>redis-server --appendonly yes 配置单机启动</li></ul></li></ul> <h3 id="_2-4-小结"><a href="#_2-4-小结" class="header-anchor">#</a> 2.4 小结</h3> <p>docker run命令的常见参数有哪些？</p> <ul><li>--name：指定容器名称</li> <li>-p：指定端口映射</li> <li>-d：让容器后台运行</li></ul> <p>查看容器日志的命令：</p> <ul><li>docker logs</li> <li>添加 -f 参数可以持续查看日志</li></ul> <p>查看容器状态：</p> <ul><li>docker ps</li> <li>docker ps -a 查看所有容器，包括已经停止的</li></ul> <h2 id="_3-数据卷"><a href="#_3-数据卷" class="header-anchor">#</a> 3. 数据卷</h2> <h3 id="_3-1-什么是数据卷"><a href="#_3-1-什么是数据卷" class="header-anchor">#</a> 3.1 什么是数据卷</h3> <p>**数据卷（volume）**是一个虚拟目录，指向宿主机文件系统中的某个目录。</p> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230612165140694.png" alt="image-20230612165140694"></p> <p>一旦完成数据卷挂载，对容器的一切操作都会作用在数据卷对应的宿主机目录了。</p> <p>这样，我们操作宿主机的/var/lib/docker/volumes/html目录，就等于操作容器内的/usr/share/nginx/html目录了</p> <h3 id="_3-2-数据集操作命令"><a href="#_3-2-数据集操作命令" class="header-anchor">#</a> 3.2 数据集操作命令</h3> <p>数据卷操作的基本语法如下：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> volume <span class="token punctuation">[</span>COMMAND<span class="token punctuation">]</span>
</code></pre></div><p>docker volume命令是数据卷操作，根据命令后跟随的command来确定下一步的操作：</p> <ul><li>create 创建一个volume</li> <li>inspect 显示一个或多个volume的信息</li> <li>ls 列出所有的volume</li> <li>prune 删除未使用的volume</li> <li>rm 删除一个或多个指定的volume</li></ul> <h3 id="_3-3-创建和查看数据卷"><a href="#_3-3-创建和查看数据卷" class="header-anchor">#</a> 3.3 创建和查看数据卷</h3> <p><strong>需求</strong>：创建一个数据卷，并查看数据卷在宿主机的目录位置</p> <p>① 创建数据卷</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> volume create html
</code></pre></div><p>② 查看所有数据</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> volume <span class="token function">ls</span>
</code></pre></div><p>③ 查看数据卷详细信息卷</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> volume inspect html
</code></pre></div><p>在结果中可以看到，创建的html这个数据卷关联的宿主机目录为<code>/var/lib/docker/volumes/html/_data</code>目录。</p> <p><strong>小结</strong>：</p> <p>数据卷的作用：</p> <ul><li>将容器与数据分离，解耦合，方便操作容器内数据，保证数据安全</li></ul> <p>数据卷操作：</p> <ul><li>docker volume create：创建数据卷</li> <li>docker volume ls：查看所有数据卷</li> <li>docker volume inspect：查看数据卷详细信息，包括关联的宿主机目录位置</li> <li>docker volume rm：删除指定数据卷</li> <li>docker volume prune：删除所有未使用的数据卷</li></ul> <h3 id="_3-4-挂载数据卷"><a href="#_3-4-挂载数据卷" class="header-anchor">#</a> 3.4 挂载数据卷</h3> <p>在创建容器时，可以通过 -v 参数来挂载一个数据卷到某个容器内目录，命令格式如下：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span> nginxContainer <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> html:/usr/share/nginx/html <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> nginx
</code></pre></div><p>这里的-v就是挂载数据卷的命令：</p> <ul><li><code>-v html:/usr/share/nginx/html</code> ：把html数据卷挂载到容器内的/usr/share/nginx/html这个目录中</li></ul> <h3 id="_3-5-案例-给nginx挂载数据卷"><a href="#_3-5-案例-给nginx挂载数据卷" class="header-anchor">#</a> 3.5 案例-给Nginx挂载数据卷</h3> <p><strong>前提</strong>：创建容器，创建数据卷html，查看数据卷详细信息卷</p> <p>① 创建容器并挂载数据卷到容器内的HTML目录</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span> nginxContainer <span class="token parameter variable">-v</span> html:/usr/share/nginx/html <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">-d</span> nginx
</code></pre></div><p>② 进入html数据卷所在位置，并修改HTML内容</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 查看html数据卷的位置</span>
<span class="token function">docker</span> volume inspect html
<span class="token comment"># 进入该目录</span>
<span class="token builtin class-name">cd</span> /var/lib/docker/volumes/html/_data
<span class="token comment"># 修改文件</span>
<span class="token function">vi</span> index.html
</code></pre></div><h3 id="_3-6-案例-给mysql挂载本地目录"><a href="#_3-6-案例-给mysql挂载本地目录" class="header-anchor">#</a> 3.6 案例-给MySQL挂载本地目录</h3> <p>容器不仅仅可以挂载数据卷，也可以直接挂载到宿主机目录上。关联关系如下：</p> <ul><li>带数据卷模式：宿主机目录 --&gt; 数据卷 ---&gt; 容器内目录</li> <li>直接挂载模式：宿主机目录 ---&gt; 容器内目录</li></ul> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230613133819066.png" alt="image-20230613133819066"></p> <p><strong>语法</strong>：</p> <p>目录挂载与数据卷挂载的语法是类似的：</p> <ul><li>-v [宿主机目录]:[容器内目录]</li> <li>-v [宿主机文件]:[容器内文件]</li></ul> <p><strong>创建并运行一个MySQL容器，将宿主机目录直接挂载到容器</strong></p> <p>**需求：**创建并运行一个MySQL容器，将宿主机目录直接挂载到容器</p> <ul><li><p><strong>前提</strong>：创建MySQL容器</p></li> <li><p>在宿舍机创建目录/tmp/mysql/data</p></li> <li><p>在宿舍机创建目录/tmp/mysql/conf，</p> <p>conf目录下创建hmy.cnf文件</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
skip-name-resolve
<span class="token assign-left variable">character_set_server</span><span class="token operator">=</span>utf8
<span class="token assign-left variable">datadir</span><span class="token operator">=</span>/var/lib/mysql
server-id<span class="token operator">=</span><span class="token number">1000</span>
</code></pre></div></li> <li><p>① 挂载/tmp/mysql/data到mysql容器内数据存储目录</p> <p>② 挂载/tmp/mysql/conf/hmy.cnf到mysql容器的配置文件</p> <p>③ 设置MySQL密码</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span> mysqlContainer <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">3307</span>:3307 <span class="token punctuation">\</span> <span class="token comment">#默认3306端口号，修改端口号后需要在hmy.cnf中添加端口号信息</span>
<span class="token parameter variable">-v</span> /tmp/mysql/conf/hmy.cnf:/etc/mysql/conf.d/hmy.cnf <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /tmp/mysql/data:/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
mysql:5.7.25
</code></pre></div><p>在hmy.cnf中添加端口号信息</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
skip-name-resolve
<span class="token assign-left variable">character_set_server</span><span class="token operator">=</span>utf8
<span class="token assign-left variable">datadir</span><span class="token operator">=</span>/var/lib/mysql
server-id<span class="token operator">=</span><span class="token number">1000</span>
<span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">3307</span>
</code></pre></div></li> <li><p>MySQL容器启动成功</p></li></ul> <h3 id="_3-7-小结"><a href="#_3-7-小结" class="header-anchor">#</a> 3.7 小结</h3> <p>docker run的命令中通过 -v 参数挂载文件或目录到容器中：</p> <ul><li>-v volume名称:容器内目录</li> <li>-v 宿主机文件:容器内文</li> <li>-v 宿主机目录:容器内目录</li></ul> <p>数据卷挂载与目录直接挂载的</p> <ul><li>数据卷挂载耦合度低，由docker来管理目录，但是目录较深，不好找</li> <li>目录挂载耦合度高，需要我们自己管理目录，不过目录容易寻找查看</li></ul> <h2 id="_4-自定义镜像"><a href="#_4-自定义镜像" class="header-anchor">#</a> 4.自定义镜像</h2> <p>常见的镜像在DockerHub就能找到，但是我们自己写的项目就必须自己构建镜像了。</p> <p>镜像就是包含了应用程序、程序运行的系统函数库、运行配置等文件的文件包。构建镜像的过程其实就是把上述文件按照顺序逐层打包。</p> <h3 id="_4-1-镜像结构"><a href="#_4-1-镜像结构" class="header-anchor">#</a> 4.1 镜像结构</h3> <p>镜像是将应用程序及其需要的系统函数库、环境、配置、依赖打包而成。</p> <p>我们以MySQL为例，来看看镜像的组成结构：</p> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230915221849440.png" alt="image-20230915221849440"></p> <p>简单来说，镜像就是在系统函数库、运行环境基础上，添加应用程序文件、配置文件、依赖文件等组合，然后编写好启动脚本打包在一起形成的文件。</p> <p>我们要构建镜像，其实就是实现上述打包的过程。</p> <h3 id="_4-2-dockerfile"><a href="#_4-2-dockerfile" class="header-anchor">#</a> 4.2 Dockerfile</h3> <p>构建自定义的镜像时，并不需要一个个文件去拷贝，打包。</p> <p>我们只需要告诉Docker，我们的镜像的组成，需要哪些BaseImage、需要拷贝什么文件、需要安装什么依赖、启动脚本是什么，将来Docker会帮助我们构建镜像。</p> <p>而描述上述信息的文件就是Dockerfile文件。</p> <p><strong>Dockerfile</strong>就是一个文本文件，其中包含一个个的<strong>指令(Instruction)</strong>，用指令来说明要执行什么操作来构建镜像。每一个指令都会形成一层Layer。</p> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230915222020632.png" alt="image-20230915222020632"></p> <p>更新详细语法说明，请参考官网文档： https://docs.docker.com/engine/reference/builder</p> <h3 id="_4-3-构建镜像"><a href="#_4-3-构建镜像" class="header-anchor">#</a> 4.3 构建镜像</h3> <p>我们可以基于Ubuntu基础影响，利用Dockerfile描述镜像结构，也可以直接基于JDK为基础镜像，省略前面的步骤：</p> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230915222201780.png" alt="image-20230915222201780"></p> <p>当编写好了Dockerfile，可以利用下面命令来构建镜像：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> myImage:1.0 <span class="token builtin class-name">.</span>
</code></pre></div><ul><li><p><strong><code>-t</code></strong> ：是给镜像起名，格式依然是repository:tag的格式，不指定tag时，默认为latest</p></li> <li><p><strong><code>.</code></strong> ：是指定Dockerfile所在目录，如果就在当前目录，则指定为&quot;.&quot;</p></li></ul> <h4 id="构建java项目"><a href="#构建java项目" class="header-anchor">#</a> 构建Java项目</h4> <p>需求：基于openjdk:11.0-jre-buster镜像，将一个Java项目构建为镜像</p> <p>实现思路如下：</p> <ul><li><p>① 新建一个空的目录，然后在目录中新建一个文件，命名为Dockerfile</p></li> <li><p>② 拷贝课前资料提供的docker-demo.jar到这个目录中</p></li> <li><p>③ 编写Dockerfile文件：</p> <ul><li><p>a ）基于openjdk:11.0-jre-buster作为基础镜像</p></li> <li><p>b ）将app.jar拷贝到镜像中</p></li> <li><p>c ）暴露端口</p></li> <li><p>d ）编写入口ENTRYPOINT</p> <p>内容如下：</p> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token comment"># 基础镜像</span>
<span class="token instruction"><span class="token keyword">FROM</span> openjdk:11.0-jre-buster</span>
<span class="token comment"># 设定时区</span>
<span class="token instruction"><span class="token keyword">ENV</span> TZ=Asia/Shanghai</span>
<span class="token instruction"><span class="token keyword">RUN</span> ln -snf /usr/share/zoneinfo/<span class="token variable">$TZ</span> /etc/localtime &amp;&amp; echo <span class="token variable">$TZ</span> &gt; /etc/timezone</span>
<span class="token comment"># 拷贝jar包</span>
<span class="token instruction"><span class="token keyword">COPY</span> docker-demo.jar /app.jar</span>
<span class="token comment"># 入口</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">&quot;java&quot;</span>, <span class="token string">&quot;-jar&quot;</span>, <span class="token string">&quot;/app.jar&quot;</span>]</span>
</code></pre></div></li></ul></li> <li><p>④ 使用docker build命令构建镜像</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> docker-demo <span class="token builtin class-name">.</span>
</code></pre></div><p>可以不指定版本号</p></li> <li><p>⑤ 使用docker run创建容器并运行</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span> docker-demo <span class="token parameter variable">-p</span> <span class="token number">8090</span>:8090 <span class="token parameter variable">-d</span> docker-demo
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>http://192.168.137.60:8090/hello/count
</code></pre></div></li></ul> <h2 id="_5-网络"><a href="#_5-网络" class="header-anchor">#</a> 5.网络</h2> <p>默认情况下，所有容器都是以bridge方式连接到Docker的一个虚拟网桥上：</p> <p><img src="https://gitee.com/tjlxy/img/raw/master/image-20230916220307968.png" alt="image-20230916220307968"></p> <p>加入自定义网络的容器才可以通过容器名互相访问，Docker的网络操作命令如下</p> <table><thead><tr><th>命令</th> <th>说明</th> <th>文档地址</th></tr></thead> <tbody><tr><td>docker network create</td> <td>创建一个网络</td> <td><a href="https://docs.docker.com/engine/reference/commandline/network_create/" target="_blank" rel="noopener noreferrer">docker   network create<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>docker network ls</td> <td>查看所有网络</td> <td><a href="https://docs.docker.com/engine/reference/commandline/network_ls/" target="_blank" rel="noopener noreferrer">docker   network ls<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>docker network rm</td> <td>删除指定网络</td> <td><a href="https://docs.docker.com/engine/reference/commandline/network_rm/" target="_blank" rel="noopener noreferrer">docker   network rm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>docker network prune</td> <td>清除未使用的网络</td> <td><a href="https://docs.docker.com/engine/reference/commandline/network_prune/" target="_blank" rel="noopener noreferrer">docker   network prune<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>docker network connect</td> <td>使指定容器连接加入某网络</td> <td><a href="https://docs.docker.com/engine/reference/commandline/network_connect/" target="_blank" rel="noopener noreferrer">docker   network connect<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>docker network disconnect</td> <td>使指定容器连接离开某网络</td> <td><a href="https://docs.docker.com/engine/reference/commandline/network_disconnect/" target="_blank" rel="noopener noreferrer">docker   network disconnect<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>docker network inspect</td> <td>查看网络详细信息</td> <td><a href="https://docs.docker.com/engine/reference/commandline/network_inspect/" target="_blank" rel="noopener noreferrer">docker   network inspect<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr></tbody></table> <p>运行容器时指定网络</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run xxx<span class="token punctuation">..</span>. <span class="token parameter variable">--network</span> 自定义网络名
</code></pre></div><h2 id="常用软件部署示例"><a href="#常用软件部署示例" class="header-anchor">#</a> 常用软件部署示例</h2> <div class="language-sh extra-class"><pre class="language-sh"><code>--Redis--
<span class="token function">docker</span> pull redis

<span class="token function">docker</span> run <span class="token parameter variable">--name</span> redisContainer <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 <span class="token parameter variable">-d</span> redis redis-server <span class="token parameter variable">--appendonly</span> <span class="token function">yes</span>


--Nginx--
<span class="token function">docker</span> pull nginx

<span class="token function">docker</span> run <span class="token parameter variable">--name</span> nginxContainer <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">-d</span> nginx
--MySQL--
<span class="token function">docker</span> load <span class="token parameter variable">-i</span> mysql.tar

<span class="token function">docker</span> run <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span> mysqlContainer <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">3307</span>:3307 <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /tmp/mysql/conf/hmy.cnf:/etc/mysql/conf.d/hmy.cnf <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /tmp/mysql/data:/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
mysql:5.7.25

需要改 conf 中文件
添加port<span class="token operator">=</span><span class="token number">3307</span>
-----------
<span class="token function">docker</span> pull rabbitmq:3-management

<span class="token function">docker</span> run <span class="token punctuation">\</span>
 <span class="token parameter variable">-e</span> <span class="token assign-left variable">RABBITMQ_DEFAULT_USER</span><span class="token operator">=</span>admin <span class="token punctuation">\</span>
 <span class="token parameter variable">-e</span> <span class="token assign-left variable">RABBITMQ_DEFAULT_PASS</span><span class="token operator">=</span><span class="token number">123</span> <span class="token punctuation">\</span>
 <span class="token parameter variable">--name</span> rabbitmqContainer <span class="token punctuation">\</span>
 <span class="token parameter variable">--hostname</span> rabbitmq <span class="token punctuation">\</span>
 <span class="token parameter variable">-p</span> <span class="token number">15672</span>:15672 <span class="token punctuation">\</span>
 <span class="token parameter variable">-p</span> <span class="token number">5672</span>:5672 <span class="token punctuation">\</span>
 <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
 rabbitmq:3-management
----------
<span class="token function">docker</span> load <span class="token parameter variable">-i</span> xxx.tar


<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">--name</span> es <span class="token punctuation">\</span>
    <span class="token parameter variable">-e</span> <span class="token string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">-e</span> <span class="token string">&quot;discovery.type=single-node&quot;</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> es-data:/usr/share/elasticsearch/data <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> es-plugins:/usr/share/elasticsearch/plugins <span class="token punctuation">\</span>
    <span class="token parameter variable">--privileged</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">--network</span> es-net <span class="token punctuation">\</span>
    <span class="token parameter variable">-p</span> <span class="token number">9200</span>:9200 <span class="token punctuation">\</span>
    <span class="token parameter variable">-p</span> <span class="token number">9300</span>:9300 <span class="token punctuation">\</span>
elasticsearch:7.12.1

http://192.168.137.60:9200/

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span> kibana <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">ELASTICSEARCH_HOSTS</span><span class="token operator">=</span>http://es:9200 <span class="token punctuation">\</span>
<span class="token parameter variable">--network</span><span class="token operator">=</span>es-net <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">5601</span>:5601  <span class="token punctuation">\</span>
kibana:7.12.1

http://192.168.137.60:5601/app/home<span class="token comment">#/</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/learn-ceiling/handbook/Learn/Microservice/08-Docker-介绍及安装.html" class="prev">
        Docker-介绍及安装
      </a></span> <span class="next"><a href="/learn-ceiling/handbook/Learn/Microservice/10-Docker-项目部署.html">
        Docker-项目部署
      </a>
      →
    </span></p></div> </main></div> <div class="footer" data-v-34d4abe6><div id="footer-info" data-v-34d4abe6><div class="footer-left" data-v-34d4abe6>
      © 2023-2024
      <span data-v-34d4abe6><a href="https://github.com/25122lxy/" target="_blank">lxy25122</a></span></div> <div class="footer-right" data-v-34d4abe6>Theme:<a href="https://github.com/JoeyBling/vuepress-theme-yilia-plus" target="_blank">vuepress-theme-yilia-plus</a> by Litten</div></div> <!----></div></main><div class="global-ui"><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:65px;bottom:0px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div><canvas id="vuepress-canvas-cursor"></canvas></div></div>
    <script src="/learn-ceiling/assets/js/app.235538a9.js" defer></script><script src="/learn-ceiling/assets/js/2.c7d2b1f7.js" defer></script><script src="/learn-ceiling/assets/js/43.cd846378.js" defer></script>
  </body>
</html>
