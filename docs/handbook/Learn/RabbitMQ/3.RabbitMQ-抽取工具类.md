## RabbitMQ-抽取工具类

### 工具类
```java
package com.tjetc.utils;

import com.rabbitmq.client.Channel;
import com.rabbitmq.client.Connection;
import com.rabbitmq.client.ConnectionFactory;

/**
 * @user 25122
 * @date 2023/4/25
 * @time 11:46
 * 此类为连接工厂创建信道的工具类
 */
public class RabbitMqUtils {
    //得到一个连接的 channel
    public static Channel getChannel() throws Exception {
        //创建一个连接工厂
        ConnectionFactory factory = new ConnectionFactory();
        factory.setHost("192.168.137.50");
        factory.setUsername("admin");
        factory.setPassword("123");
        Connection connection = factory.newConnection();
        Channel channel = connection.createChannel();
        return channel;
    }
}
```

### 通过工具类 生产消息
```java
import com.rabbitmq.client.CancelCallback;
import com.rabbitmq.client.Channel;
import com.rabbitmq.client.DeliverCallback;
import com.tjetc.utils.RabbitMqUtils;

/**
 * @user 25122
 * @date 2023/5/14
 * @time 17:18
 * @description (相当于之前生产者)
 */
public class Producer01 {

    //队列名称
    private static final String QUEUE_NAME = "queue01";

    //接收消息
    public static void main(String[] args) throws Exception{
        //利用工具类获取信道
        Channel channel = RabbitMqUtils.getChannel();

        /**
         * 生成一个队列
         * 1.队列名称
         * 2.队列里面的消息是否需要持久化（磁盘） 默认情况下消息存储在内存中
         * 3.该队列是否只供一个消费者进行消费 是否进行消息共享，true可以多个消费者消费，false只能一个消费者消费
         * 4.是否自动删除 最一个消费者断开连接后，是否自动删除，true自动删除，false不自动删除
         * 5.其他参数
         */
        channel.queueDeclare(QUEUE_NAME,false,false,false,null);
        //发消息
        String message = "数星星";
        /***
         * 发送一个消费
         * 1.发送到那个交换机
         * 2.路由的key值是那个 本次是队列的名称
         * 3.其他参数信息
         * 4.发送消息的消费体
         */
        channel.basicPublish("",QUEUE_NAME,null,message.getBytes());
        System.out.println("消息发送完毕");
        
    }
}

```

### 通过工具类 消费消息

```java
import com.rabbitmq.client.CancelCallback;
import com.rabbitmq.client.Channel;
import com.rabbitmq.client.DeliverCallback;
import com.tjetc.utils.RabbitMqUtils;

/**
 * @user 25122
 * @date 2023/4/25
 * @time 11:50
 * 这是一个工作线程 (相当于之前消费者)
 */
public class Consumer01 {

    //队列名称
    private static final String QUEUE_NAME = "queue01";

    //接收消息
    public static void main(String[] args) throws Exception{
        //利用工具类获取信道
        Channel channel = RabbitMqUtils.getChannel();

        //声明 接收消息 lambda表达式
        DeliverCallback deliverCallback = (consumerTag, message) ->{
            //转换 获取消息体
            System.out.println("接收到的消息：" + new String(message.getBody()));
        };
        //声明 取消消息时的回调
        CancelCallback cancelCallback = (consumerTag) -> {
            System.out.println("消息消费被中断");
        };
        /***
         * 消费者消费消息
         * 1.消费那个队列
         * 2.消费成功之后是否要自动应答 true代表自动应答 false代表手动应答
         * 3.消费者未成功消费的回调
         * 4.消费者取消消费者的回调
         */
        channel.basicConsume(QUEUE_NAME,true,deliverCallback,cancelCallback);

    }
}

```