# 常用基本命令

## 1. 帮助命令

### 1.1 man获得帮助信息

基本语法：man [命令或配置文件] （功能描述：获得帮助信息）

结果说明：

- NAME：命令的名称和单行描述
- SYNOPSIS：怎样使用命令
- DESCRIPTION：命令功能的深入讨论
- EXAMPLES：怎样使用命令的例子
- SEE ALSO：相关主题（通常是手册页）

eg：查看 ls 命令的帮助信息`man ls`

### 1.2 help获得shell内置命令的帮助信息

一部分基础功能的系统命令是直接内嵌在 shell 中的，系统加载启动之后会随着shell 一起加载，常驻系统内存中。这部分命令被称为“内置（built-in）命令”；相应的其它命令被称为“外部命令”。

基本语法：help 命令（功能描述：获得 shell 内置命令的帮助信息）

eg：查看cd命令的帮助信息

```shell
[lxy25122@centos7 test]$ help cd
cd: cd [-L|[-P [-e]]] [dir]
    Change the shell working directory.

    Change the current directory to DIR.  The default DIR is the value of the
    HOME shell variable.

    The variable CDPATH defines the search path for the directory containing
    DIR.  Alternative directory names in CDPATH are separated by a colon (:).
    A null directory name is the same as the current directory.  If DIR begins
    with a slash (/), then CDPATH is not used.

    If the directory is not found, and the shell option `cdable_vars' is set,
    the word is assumed to be  a variable name.  If that variable has a value,
    its value is used for DIR.

    Options:
        -L      force symbolic links to be followed
        -P      use the physical directory structure without following symbolic
        links
        -e      if the -P option is supplied, and the current working directory
        cannot be determined successfully, exit with a non-zero status

    The default is to follow symbolic links, as if `-L' were specified.

    Exit Status:
    Returns 0 if the directory is changed, and if $PWD is set successfully when
    -P is used; non-zero otherwise.
```



### 1.3 常用快捷键

| 常用快捷键  | 功能                                 |
| ----------- | ------------------------------------ |
| Ctrl+c      | 停止进程                             |
| Ctrl+l      | 清屏，等同于clear；彻底清屏是：reset |
| 善于用tab键 | 提示（更重要的是可以防止敲错）       |
| 上下键      | 查找执行过的命令                     |



## 2. 文件目录类

### 2.1 pwd显示当前工作目录的绝对路径

pwd:print working directory 打印工作目录

基本语法：pwd （功能描述：显示当前工作目录的绝对路径）

eg：显示当前工作目录的绝对路径 `pwd`

### 2.2 ls列出目录的内容

基本语法：ls [选项] [目录或是文件]

选项说明：

- -a：全部的文件，连同隐藏档( 开头为 . 的文件) 一起列出来(常用)
- -l：长数据串列出，包含文件的属性与权限等等数据；(常用)等价于“ll”

结果说明：

每行列出的信息依次是： 文件类型与权限、链接数、文件属主、文件属组、文件大小用byte来表示、建立或最近修改的时间、名字

eg：查看当前目录的所有内容信息

```shell
[lxy25122@centos7 test]$ ls -al
总用量 9200
drwxrwxr-x. 5 lxy25122 lxy25122     174 12月 11 10:38 .
drwxrwxr-x. 5 lxy25122 lxy25122     172 12月 11 10:27 ..
-rw-rw-r--. 1 lxy25122 lxy25122 4665645 12月 11 10:18 abc.txt
-rwxr--r--. 1 lxy25122 lxy25122      38 12月 10 15:28 a.sh
-rw-r--r--. 1 root     root       12288 12月 10 15:28 .a.sh.swp
-rw-rw-r--. 1 lxy25122 lxy25122 4665645 12月 11 10:19 big.txt
drwxrwxr-x. 3 lxy25122 lxy25122      45 12月 10 14:10 dir
-rw-rw-r--. 1 lxy25122 lxy25122      44 12月  9 17:17 emp_test.txt
-rw-rw-r--. 1 lxy25122 lxy25122     376 12月 12 16:25 hello.txt
-rw-r--r--. 1 lxy25122 lxy25122     367 12月 10 15:19 ifcfg-ens33
drwxrwxr-x. 3 lxy25122 lxy25122      18 12月 11 10:38 tar
drwxrwxr-x. 3 lxy25122 lxy25122     132 12月 11 10:19 test
-rw-rw-r--. 1 lxy25122 lxy25122   49340 12月 11 10:36 test.tar.gz
```

### 2.3 cd切换目录

cd:Change Directory 切换路径

基本语法：cd [参数]

参数说明：

| 参数        | 功能                                 |
| ----------- | ------------------------------------ |
| cd 绝对路径 | 切换路径                             |
| cd 相对路径 | 切换路径                             |
| cd ~或者 cd | 回到自己的家目录                     |
| cd -        | 回到上一次所在目录                   |
| cd ..       | 回到当前目录的上一级目录             |
| cd -P       | 跳转到实际物流路径，而非快捷方式路径 |

eg：cd -P

```shell
[lxy25122@centos7 data]$ ls -l
总用量 64
-rw-rw-r--. 1 lxy25122 lxy25122    35 11月  3 2022 1.txt
-rw-rw-r--. 1 lxy25122 lxy25122  3649 12月  9 12:00 emp_test.txt
-rw-rw-r--. 1 lxy25122 lxy25122   656 11月 17 2022 emp.txt
drwxrwxr-x. 2 lxy25122 lxy25122    41 11月  2 2022 flink_data
lrwxrwxrwx. 1 lxy25122 lxy25122    16 12月  9 20:12 hello -> ./test/hello.txt
drwxrwxr-x. 2 lxy25122 lxy25122    99 1月  10 2023 hive_data
-rw-rw-r--. 1 lxy25122 lxy25122 50898 12月 11 10:24 mytest.zip
drwxrwxr-x. 5 lxy25122 lxy25122   174 12月 11 10:38 test
lrwxrwxrwx. 1 lxy25122 lxy25122    11 12月  9 20:28 testDir -> ./test/dir/
[lxy25122@centos7 data]$ pwd
/home/lxy25122/data
[lxy25122@centos7 data]$ cd -P testDir/
[lxy25122@centos7 dir]$ pwd
/home/lxy25122/data/test/dir
```

### 2.4 mkdir创建一个新的目录

mkdir:Make directory 建立目录

基本语法：mkdir [选项] 要创建的目录

选型说明：

- -p：创建多层目录

eg：创建一个多级目录`mkdir -p xiyou/dssz/meihouwang`

### 2.5 rmdir删除一个空的目录

rmdir:Remove directory 移除目录

基本语法：rmdir 要删除的空目录

eg：删除一个空的文件夹`rmdir xiyou/dssz/meihouwang`

### 2.6 touch创建空文件

基本语法：touch 文件名称

eg：`touch xiyou/dssz/sunwukong.txt`

### 2.7 复制文件或目录

基本语法：cp [选项] source dest （功能描述：复制source文件到dest）

选项说明：

- -r：递归复制整个文件夹

参数说明：

- source：源文件
- dest：目标文件

注意：强制覆盖不提示的方法：\cp

eg：递归复制整个文件夹`cp -r xiyou/dssz/ ./`

### 2.8 rm删除文件或目录

基本语法：rm [选项] deleteFile （功能描述：递归删除目录中所有内容）

选型说明：

- -r：递归删除目录中所有内容
- -f：强制执行删除操作，而不提示用于进行确认
- -v：显示指令的详细执行过程

eg：递归删除目录中所有内容，并显示执行过程

```shell
[lxy25122@centos7 dir]$ rm -rfv acop/
已删除"acop/b/a"
已删除目录："acop/b"
已删除目录："acop/"
```

### 2.9 mv移动文件与目录或重命名

基本语法：

（1）mv oldNameFile newNameFile （功能描述：重命名） 

（2）mv /temp/movefile /targetFolder （功能描述：移动文件）

eg：

1）重命名`mv xiyou/dssz/suwukong.txt xiyou/dssz/houge.txt`

2）移动文件`mv xiyou/dssz/houge.txt ./`



### 2.10 cat查看文件内容

基本语法：cat [选项] 要查看的文件

选型说明：

- -n：显示所有行的行号，包括空行

注意：一般查看比较小的文件，一屏幕能显示全的

eg：查看文件内容并显示行号`cat -n houge.txt`



### 2.11 more文件内容分配查看器

more 指令是一个基于 VI 编辑器的文本过滤器，它以全屏幕的方式按页显示文本文件的内容。more 指令中内置了若干快捷键，详见操作说明。

基本语法：more 要查看的文件

操作说明：

- 空白键（space）：代表向下翻一页
- Enter：代表向下翻一行
- q：代表立刻离开more，不再显示该文件内容
- Ctrl+F：向下滚动一屏
- b：返回上一屏
- =：输出当前行的行号
- `:f`：输出文件名和当前行的行号



### 2.12 less 分屏显示文件内容

less 指令用来分屏查看文件内容，它的功能与 more 指令类似，但是比more 指令更加强大，支持各种显示终端。less 指令在显示文件内容时，并不是一次将整个文件加载之后才显示，而是根据显示需要加载内容，对于显示大型文件具有较高的效率。

基本语法：less 要查看的文件

操作说明：

- 空白键：向下翻动一页；
- [pagedown]：向下翻动一页；
- [pageup]：向上翻动一页
- /字串：向下搜寻**字串**的功能；n：向下查找；N：向上查找
- ?字串：向上搜寻**字串**的功能；n：向上查找；N：向下查找
- q：离开less这个程序

注意：

用SecureCRT时[pagedown]和[pageup]可能会出现无法识别的问题。

### 2.13 echo

echo 输出内容到控制台

基本语法：echo [选项] [输出内容]

选型：

- -e：支持反斜线控制的字符转换
- 控制字符
  - `\\`：输出\本身
  - \n：换行符
  - \t：制表符，也就是Tab键



### 2.14 head显示文件头部内容

head 用于显示文件的开头部分内容，默认情况下 head 指令显示文件的前10 行内容。

基本语法：

1、head 文件 （功能描述：查看文件头10行内容）

2、head -n 5 文件 （功能描述：查看文件头5行内容，5可以是任意行数）

选项说明：

- -n 行数：显示指定头部内容的行数

eg：查看文件的头2行`head -n 2 smartd.conf`



### 2.15 tail输出文件尾部内容

tail 用于输出文件中尾部的内容，默认情况下 tail 指令显示文件的后10 行内容

基本语法：

（1）tail 文件 （功能描述：查看文件尾部10行内容）

（2）tail -n 5 文件 （功能描述：查看文件尾部5行内容，5可以是任意行数）

（3）tail -f 文件 （功能描述：实时追踪该文档的所有更新）

选项说明：

- -n 行数：输出文件尾部n行内容
- -f：显示文件最新追加的内容，监视文件变化

eg：实时追踪文档的所有更新`tail -f abc.txt`



### 2.16 \> 输出重定向和 >> 追加

基本语法：

（1）ls -l > 文件 （功能描述：列表的内容写入文件 a.txt 中（覆盖写））

（2）ls -al >> 文件 （功能描述：列表的内容追加到文件aa.txt 的末尾）

（3）cat 文件 1 > 文件 2 （功能描述：将文件 1 的内容覆盖到文件2）

（4）echo “内容” >> 文件

eg：采用 echo 将 hello 单词追加到文件中`echo hello >> abc.txt`

### 2.17 ln软链接

软链接也称为符号链接，类似于 windows 里的快捷方式，有自己的数据块，主要存放了链接其他文件的路径。

基本语法：ln -s [原文件或目录] [软链接名] （功能描述：给原文件创建一个软链接）

- pw -P 软链接显示实际目录

注意：

删除软链接： rm -rf 软链接名，而不是 rm -rf 软链接名/ 

**如果使用 rm -rf 软链接名/ 删除，会把软链接对应的真实目录下内容删掉**

查询：通过ll就可以查看，列表属性第 1 位是l，尾部会有位置指向。

eg：

创建软链接

```shell
$ln -s xiyou/dssz/houge.txt ./houzi

$ll
lrwxrwxrwx. 1 root root 20 6 月 17 12:56 houzi -> xiyou/dssz/houge.txt
#删除软链接（注意不要写最后的/）
$rm -rf houzi
#进入软连接实际物理路径
$ln -s xiyou/dssz/ ./dssz
$cd -P dssz/
```



### 2.18 history查看已经执行过历史命令

基本语法：history （功能描述：查看已经执行过历史命令）

更多用法：

- history 10 查看最近10条执行的命令

- history -c 全部清除

```shell
[lxy25122@centos7 data]$ history 10
    1054  ls-
    1055  ls
    1056  ls -d
    1057  ls -l
    1058  cd../
    1059  cd ../
    1060  ls -l
    1061  history
    1062  echo 'aa'
    1063  history 10
[lxy25122@centos7 data]$ !1060
    ls -l
    总用量 12
    -rw-rw-r--. 1 lxy25122 lxy25122   35 11月  3 2022 1.txt
    -rw-rw-r--. 1 lxy25122 lxy25122 3649 12月  9 12:00 emp_test.txt
    -rw-rw-r--. 1 lxy25122 lxy25122  656 11月 17 2022 emp.txt
    drwxrwxr-x. 2 lxy25122 lxy25122   41 11月  2 2022 flink_data
    lrwxrwxrwx. 1 lxy25122 lxy25122   16 12月  9 20:12 hello -> ./test/hello.txt
    drwxrwxr-x. 2 lxy25122 lxy25122   99 1月  10 2023 hive_data
    drwxrwxr-x. 3 lxy25122 lxy25122   69 12月  9 20:27 test
    lrwxrwxrwx. 1 lxy25122 lxy25122   11 12月  9 20:28 testDir -> ./test/dir/
[lxy25122@centos7 data]$
```





## 3. 时间日期类

### 3.1 data显示当前时间

基本语法：

（1）date （功能描述：显示当前时间）

（2）date +%Y （功能描述：显示当前年份）

（3）date +%m （功能描述：显示当前月份）

（4）date +%d （功能描述：显示当前是哪一天）

（5）date "+%Y-%m-%d %H:%M:%S" （功能描述：显示年月日时分秒）

eg：显示当前时间年月日时分秒`date "+%Y-%m-%d %H:%M:%S"`



### 3.2 date显示非当前时间

基本语法：

（1）date -d '1 days ago' （功能描述：显示前一天时间）

（2）date -d '-1 days ago' （功能描述：显示明天时间）

### 3.3 date设置系统时间

基本语法：date -s 字符串时间

### 3.4 cal查看日历

基本语法：cal [选项] （功能描述：不加选项，显示本月日历）

- cal -y 全年度日历信息

选项说明：

- 具体某一年：显示这一年日历



## 4. 用户管理命令

### 4.1 useradd添加新用户

基本语法：

- useradd 用户名 （功能描述：添加新用户） 

- useradd -g 组名 用户名 （功能描述：添加新用户到某个组）

### 4.2 passwd设置用户密码

基本语法：passwd 用户名 （功能描述：设置用户密码）

### 4.3 id查看用户是否存在

基本语法：id 用户名

### 4.4 cat /etc/passwd查看创建了哪些用户

### 4.5 su切换用户

基本语法：

- su 用户名称 （功能描述：切换用户，只能获得用户的执行权限，不能获得环境变量）
- su - 用户名称 （功能描述：切换到用户并获得该用户的环境变量及执行权限）

### 4.6 userdel删除用户

基本语法：

（1）userdel 用户名 （功能描述：删除用户但保存用户主目录）

（2）userdel -r 用户名 （功能描述：用户和用户主目录，都删除）

选项说明：

- -r：删除用户的同时，删除与用户相关的所有文件。

### 4.7 who查看登录用户信息

基本语法：

（1）whoami （功能描述：显示自身用户名称） 

（2）who am i （功能描述：显示登录用户的用户名以及登陆时间）

eg：

```shell
    ┌──────────────────────────────────────────────────────────────────────┐
    │                 • MobaXterm Personal Edition v21.5 •                 │
    │               (SSH client, X server and network tools)               │
    │                                                                      │
    │ ➤ SSH session to lxy25122@centos7                                    │
    │   • Direct SSH      :  ✔                                             │
    │   • SSH compression :  ✔                                             │
    │   • SSH-browser     :  ✔                                             │
    │   • X11-forwarding  :  ✘  (disabled or not supported by server)      │
    │                                                                      │
    │ ➤ For more info, ctrl+click on help or visit our website.            │
    └──────────────────────────────────────────────────────────────────────┘

Last login: Wed Dec 13 19:31:46 2023 from 192.168.137.1
[lxy25122@centos7 ~]$ su -
密码：
上一次登录：三 12月 13 19:47:58 CST 2023pts/0 上
[root@centos7 ~]# #显示自身用户名称
[root@centos7 ~]# whoami
root
[root@centos7 ~]# #显示登录用户的名称
[root@centos7 ~]# who am i
lxy25122 pts/0        2023-12-14 11:08 (192.168.137.1)
```

### 4.8 sudo设置普通用户具有 root 权限

修改配置文件

`vim /etc/sudoers`找到下面一行(91 行)，在 root 下面添加一行

```shell
## Allow root to run any commands anywhere
root    	ALL=(ALL)       ALL
lxy25122 	ALL=(ALL) 		ALL
```

或者配置成采用 sudo 命令时，不需要输入密码

```shell
## Allow root to run any commands anywhere
root    	ALL=(ALL)       ALL
lxy25122 	ALL=(ALL) 		NOPASSWD:ALL
```

修改完毕，现在可以用 lxy25122帐号登录，然后用命令 sudo ，即可获得root 权限进行操作

### 4.9 usermod修改用户

基本语法：usermod -g 用户组 用户名

选项说明：

- -g：修改用户的初始登录组，给定的组必须存在。默认组id 是1。

eg：将用户加入到用户组`usermod -g duoduo lixiaoyong`



## 5. 用户组管理命令

每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同Linux 系统对用户组的规定有所不同， 

如Linux下的用户属于与它同名的用户组，这个用户组在创建用户时同时创建。

用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对/etc/group文件的更新。

### 5.1 groupadd新增组

基本语法：groupadd 组名

### 5.2 groupdel删除组

基本语法：groupdel 组名

### 5.3 groupmod修改组

基本语法：groupmod -n 新组名 老组名

选项说明：

- -n<新组名>：指定工作组的新组名

### 5.4 cat /etc/group 查看创建了哪些组



## 6. 文件权限类

### 6.1 文件属性

Linux系统是一种典型的多用户系统，不同的用户处于不同的地位，拥有不同的权限。为了保护系统的安全性，Linux系统对不同的用户访问同一文件（包括目录文件）的权限做了不同的规定。在Linux中我们可以使用ll或者ls -l命令来显示一个文件的属性以及文件所属的用户和组。

1、从左到右的 10 个字符表示，如图所示

![image-20231214194139894](https://gitee.com/tjlxy/img/raw/master/image-20231214194139894.png)

如果没有权限，就会出现减号[ - ]而已。从左至右用0-9这些数字来表示

（1）0 首位表示类型 在Linux中第一个字符代表这个文件是目录、文件或链接文件等等

- `-`代表文件 
- `d`代表目录
- `l` 链接文档(link file)； 
- （2）第1-3位确定属主（该文件的所有者）拥有该文件的权限。---User 
- （3）第4-6位确定属组（所有者的同组用户）拥有该文件的权限，---Group 
- （4）第7-9位确定其他用户拥有该文件的权限 ---Other

2、rwx 作用文件和目录的不同解释

（1）作用到文件： 

- [ r ]代表可读(read): 可以读取，查看
- [ w ]代表可写(write): 可以修改，但是不代表可以删除该文件，删除一个文件的前提条件是对该文件所在的目录有写权限，才能删除该文件
- [ x ]代表可执行(execute):可以被系统执行

（2）作用到目录：

- [ r ]代表可读(read): 可以读取，ls查看目录内容 
- [ w ]代表可写(write): 可以修改，目录内创建+删除+重命名目录
- [ x ]代表可执行(execute):可以进入该目录

```shell
[lxy25122@centos7 scripts]$ ls -l
总用量 24
-rwxrw-r--. 1 lxy25122 lxy25122  41 12月 13 19:47 add.sh
-rwxrw-r--. 1 lxy25122 lxy25122 110 12月 14 18:32 case_test.sh
-rwxr--r--. 1 lxy25122 lxy25122  62 12月 13 16:06 hello.sh
-rwxrw---x. 1 lxy25122 lxy25122 308 12月 14 18:25 if_test.sh
-rwxrw-r--. 1 lxy25122 lxy25122 219 12月 13 19:35 param.sh
-rwxrw-r--. 1 lxy25122 lxy25122 230 12月 14 19:21 sum_to.sh
```

注意：

（1）如果查看到是文件：链接数指的是硬链接个数。 （2）如果查看的是文件夹：链接数指的是子文件夹个数。

### 6.2 chmod改变权限

基本语法

![image-20231215102520082](https://gitee.com/tjlxy/img/raw/master/image-20231215102520082.png)

第一种方式变更权限 

- chmod [{ugoa}{+-=}{rwx}] 文件或目录 

第二种方式变更权限 

- chmod [mode=421 ] [文件或目录]

注意：

- u:所有者 g:所有组 o:其他人 a:所有人(u、g、o 的总和)

- r=4 w=2 x=1 rwx=4+2+1=7

eg：

（1）修改文件使其所属主用户具有执行权限`chmod u+x houge.txt`

（2）修改文件使其所属组用户具有执行权限`chmod g+x houge.txt`

（3）修改文件所属主用户执行权限,并使其他用户具有执行权限`chmod u-x,o+x houge.txt`

（4）采用数字的方式，设置文件所有者、所属组、其他用户都具有可读可写可执行权限`chmod 777 houge.txt`

（5）修改整个文件夹里面的所有文件的所有者、所属组、其他用户都具有可读可写可执行权限。`chmod -R 777 xiyou/`



### 6.3 chown改变所有者

基本语法：chown [选项] [最终用户] [文件或目录] （功能描述：改变文件或者目录的所有者）

选项说明：

- -R：递归操作

eg：

- 修改文件所有者`chown atguigu houge.txt`

- 递归改变文件所有者和所有组`chown -R atguigu:atguigu xiyou/`

### 6.4 chgrp改变所属组

基本语法：chgrp [最终用户组] [文件或目录] （功能描述：改变文件或者目录的所属组）

eg：

- 修改文件的所属组`chgrp root houge.txt`



## 7. 搜索查找类

### 7.1 find查找文件或者目录

find 指令将从指定目录向下递归地遍历其各个子目录，将满足条件的文件显示在终端。

基本语法：find [搜索范围] [选项]

选项说明：

- -name<查询方式>：按照指定的文件名查找模式查找文件

- -user<用户名>：查找属于指定用户名所有文件

- -size<文件大小>：

  - 按照指定的文件大小查找文件,单位为：

    b —— 块（512 字节），c —— 字节，w —— 字，（2 字节），k —— 千字节，M —— 兆字节，G —— 吉字节

eg：

（1）按文件名：根据名称查找/目录下的filename.txt文件。

```shell
[lxy25122@centos7 ~]$ pwd
/home/lxy25122
[lxy25122@centos7 ~]$ find ./data/test/ -name  "*.txt"
./data/test/hello.txt
./data/test/emp_test.txt
./data/test/dir/abc.txt
./data/test/dir/emp.txt
./data/test/big.txt
./data/test/abc.txt
./data/test/test/hello.txt
./data/test/test/emp_test.txt
./data/test/test/dir/abc.txt
./data/test/test/dir/emp.txt
./data/test/test/big.txt
./data/test/test/abc.txt
./data/test/tar/test/hello.txt
./data/test/tar/test/emp_test.txt
./data/test/tar/test/dir/abc.txt
./data/test/tar/test/dir/emp.txt
./data/test/tar/test/big.txt
./data/test/tar/test/abc.txt
```

（2）按拥有者：查找/opt目录下，用户名称为-user的文件

`[lxy25122@centos7 ~]$ find xiyou/ -user lxy25122`

（3）按文件大小：在/home目录下查找大于20m的文件（+n 大于-n小于n等于）

`[lxy25122@centos7 ~]$ find ./data/test -size +20480`

### 7.2 locate快速定位文件夹路径

locate 指令利用事先建立的系统中所有文件名称及路径的 locate 数据库实现快速定位给定的文件。Locate 指令无需遍历整个文件系统，查询速度较快。为了保证查询结果的准确度，管理员必须定期更新 locate 时刻。

基本语法：locate 搜索文件

注意：由于 locate 指令基于数据库进行查询，所以第一次运行前，必须使用updatedb 指令创建 locate 数据库。

eg：查询文件夹`updatedb` `locate tmp`

### 7.3 grep过滤查找及“|”管道符

管道符，“|”，表示将前一个命令的处理结果输出传递给后面的命令处理

基本语法：grep 选项 查找内容 源文件

选项说明：

- -n：显示匹配行及行号。

eg：

（1）查找某文件在第几行

```shell
[lxy25122@centos7 shells]$ ls | grep -n hello ./scripts/hello.sh
2:echo -e "hello\tworld"
4:echo "hello,$1"
```



## 8. 压缩和解压类

### 8.1 gzip/gunzip 压缩

基本语法：

- gzip 文件 （功能描述：压缩文件，只能将文件压缩为*.gz 文件）

- gunzip 文件.gz （功能描述：解压缩文件命令）

注意：

（1）只能压缩文件不能压缩目录 

（2）不保留原来的文件 

（3）同时多个文件会产生多个压缩包

eg：

- gzip压缩：`gzip houge.txt`
- gunzip解压缩文件：`gunzip houge.txt.gz`

### 8.2 zip/unzip压缩

基本语法：

- zip [选项] XXX.zip 将要压缩的内容 （功能描述：压缩文件和目录的命令）

- unzip [选项] XXX.zip （功能描述：解压缩文件）

选项说明：

- zip
  - -r：压缩目录
- unzip
  - -d<目录>：指定解压后文件的存放目录

注意：zip 压缩命令在windows/linux都通用，可以压缩目录且保留源文件。

eg：

（1）压缩 houge.txt 和bailongma.txt，压缩后的名称为mypackage.zip`zip mypackage.zip houge.txt bailongma.txt`

（2）解压 mypackage.zip`unzip mypackage.zip`

（3）解压mypackage.zip到指定目录-d`unzip mypackage.zip -d /opt`

### 8.3 tar打包

基本语法：tar [选项] XXX.tar.gz 将要打包进去的内容 （功能描述：打包目录，压缩后的文件格式.tar.gz）

选项说明：

- -c：产生.tar打包文件
- -v：显示详细信息
- -f：指定压缩后的文件名
- -z：打包同时压缩
- -x：解压.tar文件
- -C：解压到指定目录

eg：

（1）压缩多个文件`tar -zcvf houma.tar.gz houge.txt bailongma.txt`

（2）压缩目录`tar -zcvf xiyou.tar.gz xiyou/`

（3）解压到当前目录`tar -zxvf houma.tar.gz`

（4）解压到指定目录`tar -zxvf xiyou.tar.gz -C /opt`



## 9. 磁盘查看和分区类

### 9.1 du查看文件和目录占用的磁盘空间

du: disk usage 磁盘占用情况

基本语法：du 目录/文件 （功能描述：显示目录下每个子目录的磁盘使用情况）

选项说明：

- -h：以人们较易阅读的GBytes，MBytes，KBytes等格式自行显示
- -a：不仅查看子目录大小，还要包括文件
- -c：显示所有的文件和子目录大小后，显示总和
- -s：只显示总和
- --max-depth=n：指定统计子目录的深度为第n层

### 9.2 df查看磁盘空间使用情况

df: disk free 空余磁盘

基本语法：df 选项 （功能描述：列出文件系统的整体磁盘使用量，检查文件系统的磁盘空间占用情况）

选项说明：-h：以人们较易阅读的 GBytes, MBytes, KBytes 等格式自行显示；

- df -h

```shell
[root@centos7 scripts]# df -h
文件系统                 容量  已用  可用 已用% 挂载点
devtmpfs                 2.9G     0  2.9G    0% /dev
tmpfs                    2.9G     0  2.9G    0% /dev/shm
tmpfs                    2.9G   12M  2.9G    1% /run
tmpfs                    2.9G     0  2.9G    0% /sys/fs/cgroup
/dev/mapper/centos-root   27G   13G   15G   47% /
/dev/sda1               1014M  151M  864M   15% /boot
tmpfs                    579M     0  579M    0% /run/user/1000
tmpfs                    579M     0  579M    0% /run/user/1003
tmpfs                    579M     0  579M    0% /run/user/1002
```



### 9.3 lsblk查看设备挂载情况

基本语法：lsblk （功能描述：查看设备挂载情况）

选项说明：-f：查看详细的设备挂载情况，显示文件系统信息

```shell
[root@centos7 scripts]# lsblk -f
NAME            FSTYPE      LABEL           UUID                                   MOUNTPOINT
sda
├─sda1          xfs                         3c2ad6f3-9270-4aee-96e2-1e4ba94d0926   /boot
└─sda2          LVM2_member                 t1jCK3-MhGP-pzOz-bbw3-d4gx-JvKG-Ca95wp
  ├─centos-root xfs                         1d975a1c-fcf8-4474-a68c-c62e06574fa4   /
  └─centos-swap swap                        32c77d13-47e2-4b34-9d46-9ed3664fb6ed   [SWAP]
sr0             iso9660     CentOS 7 x86_64 2020-11-04-11-36-43-00
```



### 9.4 mount/umount挂载/卸载

对于Linux用户来讲，不论有几个分区，分别分给哪一个目录使用，它总归就是一个根目录、一个独立且唯一的文件结构。 

Linux中每个分区都是用来组成整个文件系统的一部分，它在用一种叫做“挂载”的处理方法，它整个文件系统中包含了一整套的文件和目录，并将一个分区和一个目录联系起来，要载入的那个分区将使它的存储空间在这个目录下获得。

基本语法：

- mount [-t vfstype] [-o options] device dir （功能描述：挂载设备）
- umount 设备文件名或挂载点 （功能描述：卸载设备）

参数说明：

- -t vfstype

  指定文件系统的类型，通常不必指定。mount 会自动选择正确的类型。常用类型有： 

  光盘或光盘镜像：iso9660 

  DOS fat16 文件系统：msdos 

  Windows 9x fat32 文件系统：vfat 

  Windows NT ntfs 文件系统：ntfs Mount

  Windows 文件网络共享：smbfs 

  UNIX(LINUX) 文件网络共享：nfs

- -o options

  主要用来描述设备或档案的挂接方式。常用的参数有：

  loop：用来把一个文件当成硬盘分区挂接上系统

  ro：采用只读方式挂接设备 

  rw：采用读写方式挂接设备 

  iocharset：指定访问文件系统所用字符集

- device：要挂接(mount)的设备

- dir：设备在系统上的挂接点(mount point)

eg：

（1）挂载光盘镜像文件

```shell
$ mkdir /mnt/cdrom/ #建立挂载点
$ mount -t iso9660 /dev/cdrom /mnt/cdrom/ #设备/dev/cdrom挂载到挂载点 ： /mnt/cdrom 中
$ ll /mnt/cdrom/ #查看挂载的文件
```

（2）卸载光盘镜像文件`umount /mnt/cdrom`

设置开机自动挂载

`vi /etc/fstab`

依照其他格式在后面进行编写`/dev/cdrom	/mnt/cdrom	iso9660	defaults	0	0`

### 9.5 fdisk分区

基本语法：

- fdisk -l （功能描述：查看磁盘分区详情） 

- fdisk 硬盘设备名 （功能描述：对新增硬盘进行分区操作）

选项说明：

- -l：显示所有硬盘的分区列表

注意：该命令必须在 root 用户下才能使用

功能说明：

（1）Linux 分区 

**Device**：分区序列 

Boot：引导 

Start：从X磁柱开始 

End：到Y磁柱结束 

**Blocks**：容量 

Id：分区类型ID 

System：分区类型 

（2）分区操作按键说明 

m：显示命令列表 

p：显示当前磁盘分区 

n：新增分区 

w：写入分区信息并退出 

q：不保存分区信息直接退出

eg：

```shell
[root@centos7 scripts]# fdisk -l

磁盘 /dev/sda：32.2 GB, 32212254720 字节，62914560 个扇区
Units = 扇区 of 1 * 512 = 512 bytes
扇区大小(逻辑/物理)：512 字节 / 512 字节
I/O 大小(最小/最佳)：512 字节 / 512 字节
磁盘标签类型：dos
磁盘标识符：0x000bf72c

   设备 Boot      Start         End      Blocks   Id  System
/dev/sda1   *        2048     2099199     1048576   83  Linux
/dev/sda2         2099200    62914559    30407680   8e  Linux LVM

磁盘 /dev/mapper/centos-root：29.0 GB, 28982640640 字节，56606720 个扇区
Units = 扇区 of 1 * 512 = 512 bytes
扇区大小(逻辑/物理)：512 字节 / 512 字节
I/O 大小(最小/最佳)：512 字节 / 512 字节


磁盘 /dev/mapper/centos-swap：2147 MB, 2147483648 字节，4194304 个扇区
Units = 扇区 of 1 * 512 = 512 bytes
扇区大小(逻辑/物理)：512 字节 / 512 字节
I/O 大小(最小/最佳)：512 字节 / 512 字节
```





## 10. 进程管理类

进程是正在执行的一个程序或命令，每一个进程都是一个运行的实体，都有自己的地址空间，并占用一定的系统资源。

### 10.1 ps查看当前系统进程状态

ps:process status 进程状态

基本语法：

- ps aux | grep xxx （功能描述：查看系统中所有进程） 
- ps -ef | grep xxx （功能描述：可以查看子父进程之间的关系）

选项说明：

- a：列出带有终端的所有用户的进程
- x：列出当前用户的所有进程，包括没有终端的进程
- u：面向用户友好的显示风格
- -e：列出所有进程
- -u：列出某个用户关联的所有进程
- -f：显示完整格式的进程列表

功能说明：

（1）ps aux 显示信息说明 

USER：该进程是由哪个用户产生的 

PID：进程的 ID 号 

**%CPU**：该进程占用 CPU 资源的百分比，占用越高，进程越耗费资源；

**%MEM**：该进程占用物理内存的百分比，占用越高，进程越耗费资源；

VSZ：该进程占用虚拟内存的大小，单位 KB； 

RSS：该进程占用实际物理内存的大小，单位 KB； 

TTY：该进程是在哪个终端中运行的。对于 CentOS 来说，tty1 是图形化终端，tty2-tty6 是本地的字符界面终端。pts/0-255 代表虚拟终端。

STAT：进程状态。常见的状态有：R：运行状态、S：睡眠状态、T：暂停状态、Z：僵尸状态、s：包含子进程、l：多线程、+：前台显示

START：该进程的启动时间

TIME：该进程占用 CPU 的运算时间，注意不是系统时间 

COMMAND：产生此进程的命令名

（2）ps -ef 显示信息说明 

UID：用户 ID 

**PID**：进程 ID 

**PPID**：父进程 ID 

C：CPU 用于计算执行优先级的因子。数值越大，表明进程是CPU 密集型运算，执行优先级会降低；数值越小，表明进程是 I/O 密集型运算，执行优先级会提高

STIME：进程启动的时间 

TTY：完整的终端名称 

TIME：CPU 时间 

CMD：启动进程所用的命令和参数

注意：

如果想查看进程的 CPU 占用率和内存占用率，可以使用 aux; 

如果想查看进程的父进程 ID 可以使用 ef;

eg：

```shell
[root@centos7 scripts]# ps aux | head -n 10
USER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root          1  0.0  0.1 193580  6780 ?        Ss   17:47   0:02 /usr/lib/systemd/systemd --switched-root --system --deserialize 22
root          2  0.0  0.0      0     0 ?        S    17:47   0:00 [kthreadd]
root          3  0.0  0.0      0     0 ?        S    17:47   0:04 [kworker/0:0]
root          4  0.0  0.0      0     0 ?        S<   17:47   0:00 [kworker/0:0H]
root          6  0.0  0.0      0     0 ?        S    17:47   0:00 [ksoftirqd/0]
root          7  0.0  0.0      0     0 ?        S    17:47   0:00 [migration/0]
root          8  0.0  0.0      0     0 ?        S    17:47   0:00 [rcu_bh]
root          9  0.0  0.0      0     0 ?        S    17:47   0:11 [rcu_sched]
root         10  0.0  0.0      0     0 ?        S<   17:47   0:00 [lru-add-drain]

[root@centos7 scripts]# ps -ef | head -n 10
UID         PID   PPID  C STIME TTY          TIME CMD
root          1      0  0 17:47 ?        00:00:02 /usr/lib/systemd/systemd --switched-root --system --deserialize 22
root          2      0  0 17:47 ?        00:00:00 [kthreadd]
root          3      2  0 17:47 ?        00:00:04 [kworker/0:0]
root          4      2  0 17:47 ?        00:00:00 [kworker/0:0H]
root          6      2  0 17:47 ?        00:00:00 [ksoftirqd/0]
root          7      2  0 17:47 ?        00:00:00 [migration/0]
root          8      2  0 17:47 ?        00:00:00 [rcu_bh]
root          9      2  0 17:47 ?        00:00:11 [rcu_sched]
root         10      2  0 17:47 ?        00:00:00 [lru-add-drain]
```

### 10.2 kill 终止进程

基本语法：

- kill [选项] 进程号 （功能描述：通过进程号杀死进程） 
- killall 进程名称 （功能描述：通过进程名称杀死进程，也支持通配符，这在系统因负载过大而变得很慢时很有用）

选项说明：

- -9：表示强迫进程立即停止

### 10.3 pstree查看进程树

基本语法：pstree [选项]

选项说明：

- -p：显示进程的 PID
- -u：显示进程的所属用户

eg：

（1）显示进程 pid

```shell
[lxy25122@centos7 ~]$ pstree -p | head -10
systemd(1)-+-NetworkManager(733)-+-{NetworkManager}(754)
           |                     `-{NetworkManager}(756)
           |-VGAuthService(727)
           |-agetty(744)
           |-auditd(690)---{auditd}(691)
           |-beam.smp(1005)-+-erl_child_setup(1493)---inet_gethost(1635)---inet_gethost(1636)
           |                |-{beam.smp}(1416)
           |                |-{beam.smp}(1424)
           |                |-{beam.smp}(1425)
           |                |-{beam.smp}(1426)
           ...
```

（2）显示进程所属用户

```shell
[lxy25122@centos7 ~]$ pstree -u
systemd─┬─NetworkManager───2*[{NetworkManager}]
        ├─VGAuthService
        ├─agetty
        ├─auditd───{auditd}
        ├─beam.smp(rabbitmq)─┬─erl_child_setup───inet_gethost───inet_gethost
        │                    └─86*[{beam.smp}]
        ├─chronyd(chrony)
        ├─crond
        ├─dbus-daemon(dbus)───{dbus-daemon}
        ├─epmd(rabbitmq)
        ├─irqbalance
        ├─lvmetad
        ├─mysqld(mysql)───26*[{mysqld}]
        ├─polkitd(polkitd)───6*[{polkitd}]
        ├─rsyslogd───2*[{rsyslogd}]
        ├─sshd─┬─sshd───sshd(lxy25122)─┬─bash───pstree
        │      │                       └─bash───sleep
        │      └─sshd───sshd(lxy25122)───sftp-server
        ├─systemd-journal
        ├─systemd-logind
        ├─systemd-udevd
        ├─tuned───4*[{tuned}]
        └─vmtoolsd───2*[{vmtoolsd}]
```

### 10.4 top实时监控系统进程状态

基本命令：top [选项]

选项说明：

- -d：秒数 指定 top 命令每隔几秒更新。默认是 3 秒在 top 命令的交互模式当中可以执行的命令
- -i：使 top 不显示任何闲置或者僵死进程。
- -p：通过指定监控进程 ID 来仅仅监控某个进程的状态。

操作说明：

- P：以 CPU 使用率排序，默认就是此项
- M：以内存的使用率排序
- N：以 PID 排序
- q：退出 top

查询结果字段解释

第一行信息为任务队列信息

| 内容                           | 说明                                                         |
| ------------------------------ | ------------------------------------------------------------ |
| 12:26:46                       | 系统当前时间                                                 |
| up 1 day, 13:32                | 系统的运行时间，本机已经运行1 天                             |
| 2 users                        | 当前登录了两个用户                                           |
| load average: 0.00, 0.00, 0.00 | 系统在之前 1 分钟，5 分钟，15 分钟的平均负系统在之前 1 分钟，5 分钟，15 分钟的平均负载。一般认为小于 1 时，负载较小。如果大于1，系统已经超出负荷。 |

第二行为进程信息

| 内容            | 说明                                       |
| --------------- | ------------------------------------------ |
| Tasks: 95 total | 系统中的进程总数                           |
| 1 running       | 正在运行的进程数                           |
| 94 sleeping     | 睡眠的进程                                 |
| 0 stopped       | 正在停止的进程                             |
| 0 zombie        | 僵尸进程。如果不是 0，需要手工检查僵尸进程 |

第三行为 CPU 信息

| 内容           | 说明                                                         |
| -------------- | ------------------------------------------------------------ |
| Cpu(s): 0.1%us | 用户模式占用的 CPU 百分比                                    |
| 0.1%sy         | 系统模式占用的 CPU 百分比                                    |
| 0.0%ni         | 改变过优先级的用户进程占用的CPU 百分比                       |
| 99.7%id        | 空闲 CPU 的 CPU 百分比                                       |
| 0.1%wa         | 等待输入/输出的进程的占用CPU 百分比                          |
| 0.0%hi         | 硬中断请求服务占用的 CPU 百分比                              |
| 0.1%si         | 软中断请求服务占用的 CPU 百分比                              |
| 0.0%st st      | （Steal time）虚拟时间百分比。就是当有虚拟机时，虚拟 CPU 等待实际 CPU 的时间百分比 |

第四行为物理内存信息

| 内容               | 说明                                                         |
| ------------------ | ------------------------------------------------------------ |
| Mem: 625344k total | 物理内存的总量，单位 KB                                      |
| 571504k used       | 已经使用的物理内存数量                                       |
| 53840k free        | 空闲的物理内存数量，我们使用的是虚拟机，总共只分配了 628MB 内存，所以只有53MB的空闲内存了 |
| 65800k buffers     | 作为缓冲的内存数量                                           |

第五行为交换分区（swap）信息

| 内容                | 说明                         |
| ------------------- | ---------------------------- |
| Swap: 524280k total | 交换分区（虚拟内存）的总大小 |
| 0k used             | 已经使用的交互分区的大小     |
| 524280k free        | 空闲交换分区的大小           |
| 409280k cached      | 作为缓存的交互分区的大小     |



### 10.5 netstat显示网络状态和端口占用信息

基本语法：

- netstat -anp | grep 进程号 （功能描述：查看该进程网络信息）

- netstat –nlp | grep 端口号 （功能描述：查看网络端口号占用情况）

选项说明：

- -a：显示所有正在监听（listen）和未监听的套接字（socket）
- -n：拒绝显示别名，能显示数字的全部转化成数字
- -l：仅列出在监听的服务状态
- -p：表示显示哪个进程在调用

eg：

（1）通过进程号查看sshd进程的网络信息

```shell
[root@centos7 ~]# netstat -anp | grep sshd
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1007/sshd
tcp        0      0 192.168.137.50:22       192.168.137.1:7888      ESTABLISHED 2277/sshd: lxy25122
tcp        0      0 192.168.137.50:22       192.168.137.1:7883      ESTABLISHED 2238/sshd: lxy25122
tcp6       0      0 :::22                   :::*                    LISTEN      1007/sshd
unix  3      [ ]         STREAM     CONNECTED     25689    2279/sshd: lxy25122
unix  2      [ ]         DGRAM                    25033    2277/sshd: lxy25122
unix  3      [ ]         STREAM     CONNECTED     25690    2238/sshd: lxy25122
unix  3      [ ]         STREAM     CONNECTED     20051    1007/sshd
unix  3      [ ]         STREAM     CONNECTED     25036    2291/sshd: lxy25122
unix  2      [ ]         DGRAM                    25686    2238/sshd: lxy25122
unix  3      [ ]         STREAM     CONNECTED     25037    2277/sshd: lxy25122
```

（2）查看某端口号是否被占用

```shell
[root@centos7 ~]# netstat -nltp | grep 22
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1007/sshd
tcp6       0      0 :::22                   :::*                    LISTEN      1007/sshd
```



## 11. crontab系统定时任务

### 11.1 crontab服务管理

重新启动crontab服务

`systemctl restart crond`

### 11.2 crontab定时任务设置

基本语法：crontab [选项]

选项说明：

- -e：编辑 crontab 定时任务
- -l：查询 crontab 任务
- -r：删除当前用户所有的crontab任务

参数说明：

（1）\* * * * * 执行的任务

- 第一个“*”：一小时当中的第几分钟（0-59）
- 第二个“*”：一天当中的第几小时（0-23）
- 第三个“*”：一个月当中的第几天（1-31）
- 第四个“*”：一年当中的第几月（1-12）
- 第五个“*”：一周当中的星期几【 0-7（0 和7 都代表星期日）】

（2）特殊符号

- \*代表任何时间。比如第一个“*”就代表一小时中每分钟都执行一次的意思。 
- `，` 代表不连续的时间。比如“0 8,12,16 * * * 命令”，就代表在每天的 8 点 0 分，12 点 0 分，16 点0 分都执行一次命令
- `-` 代表连续的时间范围。比如“0 5 * * 1-6 命令”，代表在周一到周六的凌晨 5 点 0 分执行命令
- `*/n` 代表每隔多久执行一次。比如“*/10 * * * * 命令”，代表每隔 10 分钟执行一遍命令

（3）特定时间执行命令

- 45 22 * * *：命令 每天 22 点 45 分执行命令
- 0 17 * * 1 ：命令 每周 1 的 17 点 0 分执行命令
- 0 5 1,15 * *：命令 每月 1 号和 15 号的凌晨 5 点 0 分执行命令
- 40 4 * * 1-5：命令 每周一到周五的凌晨 4 点 40 分执行命令
- */10 4 * * *：命令 每天的凌晨 4 点，每隔 10 分钟执行一次命令
- 0 0 1,15 * 1：命令 每月 1 号和 15 号，每周 1 的 0 点 0 分都会执行命令。注意：星期几和几号最好不要同时出现，因为他们定义的都是天。非常容易让管理员混乱

eg：

每隔 1 分钟，向/root/bailongma.txt 文件中添加一个 11 的数字

`*/1 * * * * /bin/echo ”11” >> /root/bailongma.txt`

每天凌晨2点执行daily_archive脚本

`0 2 * * * /home/lxy25122/data/shells/scripts/daily_archive.sh /home/lxy25122/data/shells`



## Other

`cal -y` 全年度日历信息

`wc 文件` 行数，词数，字节大小，文件名

`tree` 目录 可以树形结构查看目录中文件

`free -h` 查看内存

```shell
if [ xx ] && [ yy ]  #等价于if [xx -a yy]
then echo 'xxx'
fi
```



正则表达式-匹配11位手机号
`| grep -E ^1[3,4,5,7,8][0-9]{9}$`
